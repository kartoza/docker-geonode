# Kartoza GeoNode specifically wants to have postgis:// url schema for database connection

import os

# process this only if GEONODE_DATABASE_USER is specified
# that means we are asked to construct the DATABASE_URL directly
GEONODE_DATABASE_USER = os.environ.get('GEONODE_DATABASE_USER')
GEONODE_DATABASE_PASSWORD = os.environ.get('GEONODE_DATABASE_PASSWORD')
GEONODE_DATABASE = os.environ.get('GEONODE_DATABASE')
GEONODE_DATABASE_HOST = os.environ.get('GEONODE_DATABASE_HOST')
GEONODE_DATABASE_PORT = os.environ.get('GEONODE_DATABASE_PORT', '5432')
if GEONODE_DATABASE_USER and GEONODE_DATABASE_PASSWORD and GEONODE_DATABASE_HOST and GEONODE_DATABASE:
    DATABASE_URL = 'postgis://{}:{}@{}:{}/{}'.format(GEONODE_DATABASE_USER, GEONODE_DATABASE_PASSWORD, GEONODE_DATABASE_HOST, GEONODE_DATABASE_PORT, GEONODE_DATABASE)
    os.environ['DATABASE_URL'] = DATABASE_URL

# process this only if GEONODE_GEODATABASE_USER is specified
# Geodatabase connection details for datastore
GEONODE_GEODATABASE_USER = os.environ.get('GEONODE_GEODATABASE_USER')
GEONODE_GEODATABASE_PASSWORD = os.environ.get('GEONODE_GEODATABASE_PASSWORD')
GEONODE_GEODATABASE = os.environ.get('GEONODE_GEODATABASE')
GEONODE_GEODATABASE_HOST = os.environ.get('GEONODE_GEODATABASE_HOST')
GEONODE_GEODATABASE_PORT = os.environ.get('GEONODE_GEODATABASE_PORT', '5432')
if GEONODE_GEODATABASE_USER and GEONODE_GEODATABASE_PASSWORD and GEONODE_GEODATABASE_HOST and GEONODE_GEODATABASE:
    GEODATABASE_URL = 'postgis://{}:{}@{}:{}/{}'.format(GEONODE_GEODATABASE_USER, GEONODE_GEODATABASE_PASSWORD, GEONODE_GEODATABASE_HOST, GEONODE_GEODATABASE_PORT, GEONODE_GEODATABASE)
    os.environ['GEODATABASE_URL'] = GEODATABASE_URL

# import generic settings
from geonode.settings import *
